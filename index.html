<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Smart Pantry</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    display: flex;
    height: 100vh;
    background: #f4f4f9;
    overflow: hidden;
  }

  /* Sidebar */
  .sidebar {
    width: 200px;
    background: #fff;
    border-right: 1px solid #ccc;
    display: flex;
    flex-direction: column;
    padding: 10px;
    overflow-y: auto;
  }

  .sidebar h2 {
    cursor: pointer;
    margin: 10px 0;
    font-size: 16px;
    display: flex;
    justify-content: space-between;
  }

  .sidebarContent {
    margin-left: 5px;
    margin-bottom: 10px;
  }

  .collapsed {
    display: none;
  }

  /* Main content */
  .main {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
  }

  h1 {
    text-align: center;
    margin-bottom: 20px;
    color: #333;
  }

  /* Sections */
  .section {
    background: #fff;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  .section h2 {
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    margin: 0;
    font-size: 16px;
  }

  .content {
    margin-top: 10px;
    display: block;
    transition: max-height 0.3s ease;
    overflow: hidden;
  }

  /* Inputs */
  input, textarea, button {
    padding: 8px;
    margin: 5px 0;
    width: 95%;
    box-sizing: border-box;
    border-radius: 5px;
    border: 1px solid #ccc;
  }

  button {
    cursor: pointer;
    background: #4CAF50;
    color: white;
    border: none;
    transition: 0.2s;
  }

  button:hover {
    background: #45a049;
  }

  /* Ingredients / Recipes */
  .ingredient, .recipe, .recipeItem {
    padding: 5px;
    border-bottom: 1px solid #ccc;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 5px;
    margin: 3px 0;
  }

  .remove {
    color: red;
    cursor: pointer;
    margin-left: 10px;
  }

  .instructions {
    margin-left: 20px;
    font-style: italic;
    color: #555;
    display: none;
  }

  .quantity {
    font-weight: bold;
    margin-left: 5px;
  }
</style>
</head>
<body>

<!-- Sidebar -->
<div class="sidebar">
  <h2 onclick="toggleSidebarContent('pantrySidebar')">Pantry ▼</h2>
  <div id="pantrySidebar" class="sidebarContent"></div>

  <h2 onclick="toggleSidebarContent('recipesSidebar')">Recipes ▼</h2>
  <div id="recipesSidebar" class="sidebarContent"></div>
</div>

<!-- Main content -->
<div class="main">
  <h1>Smart Pantry</h1>

  <div class="section">
    <h2 onclick="toggleSection('ingredientSection')">Add Ingredient ▼</h2>
    <div class="content" id="ingredientSection">
      <input type="text" id="ingredientInput" placeholder="Ingredient name">
      <input type="text" id="ingredientQty" placeholder="Quantity (e.g., 2 cups, 1 loaf)">
      <button onclick="addIngredient()">Add</button>
    </div>
  </div>

  <!-- Pantry display in main content -->
  <div class="section">
    <h2 onclick="toggleSection('pantrySection')">Pantry ▼</h2>
    <div class="content" id="pantrySection">
      <div id="ingredientList"></div>
    </div>
  </div>

  <div class="section">
    <h2 onclick="toggleSection('addRecipeSection')">Add Recipe ▼</h2>
    <div class="content" id="addRecipeSection">
      <input type="text" id="recipeName" placeholder="Recipe name">
      <input type="text" id="recipeIngredients" placeholder="Ingredients (comma-separated, e.g., cheddar:1 cup, milk:2 cups)">
      <textarea id="recipeInstructions" placeholder="Instructions"></textarea>
      <button onclick="addRecipe()">Add Recipe</button>
    </div>
  </div>

  <div class="section">
    <h2 onclick="toggleSection('recipeSuggestions')">Recipe Suggestions ▼</h2>
    <div class="content" id="recipeSuggestions">
      <div id="recipeList"></div>
    </div>
  </div>
</div>

<script>
// Collapsible sections
function toggleSection(id){
  const sec=document.getElementById(id);
  sec.style.display=(sec.style.display==="none"?"block":"none");
}
function toggleSidebarContent(id){
  const sec=document.getElementById(id);
  sec.style.display=(sec.style.display==="none"?"block":"none");
}

// --- Pantry & Recipes ---
let pantry = JSON.parse(localStorage.getItem('pantry')) || [];
let recipes = JSON.parse(localStorage.getItem('recipes')) || [];

// --- AI / Spell check ---
function normalizeIngredient(name){
  name=name.toLowerCase().trim();
  const groups={
    "cheddar":["cheddar","chease","chedar","cheese","sharp cheddar"],
    "bread":["bread","bred","loaf"],
    "eggs":["egg","eggs"],
    "milk":["milk","mylk"],
    "butter":["butter","buttr"],
    "pasta":["pasta","spaghetti","macaroni"]
  };
  for(const k in groups) if(groups[k].some(a=>name.includes(a))) return k;
  return name;
}

// --- Quantities ---
function parseQuantity(qty){ const m=qty.trim().match(/^(\d+)\s*(.+)$/); return m?{amount:parseInt(m[1]),unit:m[2].toLowerCase()}:{amount:1,unit:qty}; }
function combineQuantities(o,n){ const p1=parseQuantity(o), p2=parseQuantity(n); return p1.unit===p2.unit?`${p1.amount+p2.amount} ${p1.unit}`:`${o} + ${n}`; }

// --- Pantry ---
function addIngredient(){
  const name=normalizeIngredient(document.getElementById("ingredientInput").value);
  const qty=document.getElementById("ingredientQty").value.trim()||"1 unit";
  if(!name) return;
  const existing=pantry.find(i=>i.name===name);
  if(existing) existing.qty=combineQuantities(existing.qty,qty);
  else pantry.push({name,qty});
  savePantry(); 
  document.getElementById("ingredientInput").value=""; 
  document.getElementById("ingredientQty").value="";
  updatePantry(); 
  updatePantrySidebar(); 
  updateRecipes(); 
  updateSidebarList();
}
function removeIngredient(name){ 
  pantry=pantry.filter(i=>i.name!==name); 
  savePantry(); 
  updatePantry(); 
  updatePantrySidebar(); 
  updateRecipes(); 
}
function updatePantry(){
  const list=document.getElementById("ingredientList"); 
  list.innerHTML="";
  pantry.forEach(item=>{
    const d=document.createElement("div"); 
    d.className="ingredient"; 
    d.innerHTML=`<span>${item.name} <span class="quantity">(${item.qty})</span></span>`; 
    const r=document.createElement("span"); 
    r.className="remove"; 
    r.textContent="✖"; 
    r.onclick=()=>removeIngredient(item.name); 
    d.appendChild(r); 
    list.appendChild(d); 
  });
}
function updatePantrySidebar(){
  const list=document.getElementById("pantrySidebar"); 
  list.innerHTML="";
  pantry.forEach(item=>{
    const d=document.createElement("div"); 
    d.className="ingredient"; 
    d.textContent=`${item.name} (${item.qty})`; 
    list.appendChild(d);
  });
}

// --- Recipes ---
function addRecipe(){
  const name=document.getElementById("recipeName").value.trim();
  const ingredientsRaw=document.getElementById("recipeIngredients").value.split(",");
  const instructions=document.getElementById("recipeInstructions").value.trim();
  if(!name || ingredientsRaw.length===0) return;
  const ingredients=ingredientsRaw.map(i=>{let p=i.split(":"); return {name:normalizeIngredient(p[0]), qty:p[1]?p[1].trim():"1 unit"};});
  recipes.push({name,ingredients,instructions});
  saveRecipes(); 
  document.getElementById("recipeName").value=""; 
  document.getElementById("recipeIngredients").value=""; 
  document.getElementById("recipeInstructions").value="";
  updateRecipes(); 
  updateSidebarList();
}
function deleteRecipe(index){ 
  recipes.splice(index,1); 
  saveRecipes(); 
  updateRecipes(); 
  updateSidebarList();
}
function updateRecipes(){
  const list=document.getElementById("recipeList"); 
  list.innerHTML="";
  const sorted=recipes.slice().sort((a,b)=> (b.ingredients.every(i=>pantry.find(p=>p.name===i.name))?1:0)-(a.ingredients.every(i=>pantry.find(p=>p.name===i.name))?1:0));
  sorted.forEach(recipe=>{
    const missing=recipe.ingredients.filter(i=>!pantry.find(p=>p.name===i.name)); 
    const div=document.createElement("div"); 
    div.className="recipe"; 
    div.textContent=recipe.name+(missing.length===0?" ✅ You have all ingredients!":" ❌ Missing: "+missing.map(m=>m.name).join(", ")); 
    const instr=document.createElement("div"); 
    instr.className="instructions"; 
    instr.innerHTML=recipe.ingredients.map(i=>`${i.name} (${i.qty})`).join(",")+"<br><br>"+(recipe.instructions||"No instructions added."); 
    div.onclick=()=>{instr.style.display=instr.style.display==="none"?"block":"none";}; 
    list.appendChild(div); 
    list.appendChild(instr);
  });
}
function updateSidebarList(){
  const s=document.getElementById("recipesSidebar"); 
  s.innerHTML=""; 
  recipes.forEach((r,i)=>{
    const d=document.createElement("div"); 
    d.className="recipeItem"; 
    d.textContent=r.name; 
    const rem=document.createElement("span"); 
    rem.className="remove"; 
    rem.textContent="✖"; 
    rem.onclick=()=>deleteRecipe(i); 
    d.appendChild(rem); 
    s.appendChild(d);
  });
}

// Local storage
function savePantry(){ localStorage.setItem('pantry',JSON.stringify(pantry)); }
function saveRecipes(){ localStorage.setItem('recipes',JSON.stringify(recipes)); }

// Init
updatePantry(); updatePantrySidebar(); updateRecipes(); updateSidebarList();

</script>
</body>
</html>

